diff --git a/main.py b/main.py
index 567b3a8..ccd43a0 100644
--- a/main.py
+++ b/main.py
@@ -1,56 +1,63 @@
+import argparse
 import json
-from pptx import Presentation
 import os
+from pptx import Presentation
 
 from tools.slide_types import (
     add_title_slide,
     add_section_slide,
     add_content_slide,
-    add_closing_slide
+    add_closing_slide,
 )
 from tools.background_utils import set_background
 
 
 # ---------- è½½å…¥æ¨¡æ¿æ–‡ä»¶ ----------
 def load_json(path):
     with open(path, "r", encoding="utf-8") as f:
         return json.load(f)
 
 
-template_file = "slides/å¤œæ¸¸å®«.json"
-style_file = "styles/style1.json"
+def main():
+    parser = argparse.ArgumentParser(description="Generate PPT from templates")
+    parser.add_argument("--template", default="slides/å¤œæ¸¸å®«.json", help="slide template JSON")
+    parser.add_argument("--style", default="styles/style1.json", help="style JSON")
+    parser.add_argument("--output_dir", default="output", help="directory for generated ppt")
+    parser.add_argument("--image_dir", default="images", help="directory for slide images")
+    args = parser.parse_args()
+
+    template = load_json(args.template)
+    style_data = load_json(args.style)
+    style = style_data["style"]
 
-template_name = os.path.splitext(os.path.basename(template_file))[0]
-style_name = os.path.splitext(os.path.basename(style_file))[0]
+    template_name = os.path.splitext(os.path.basename(args.template))[0]
+    style_name = os.path.splitext(os.path.basename(args.style))[0]
+    output_file = f"{template_name}_{style_name}.pptx"
+    output_path = os.path.join(args.output_dir, output_file)
 
-output_file = f"{template_name}_{style_name}.pptx"
-output_path = os.path.join("output", output_file)
+    prs = Presentation()
 
-template = load_json(template_file)
-style_data = load_json(style_file)
-style = style_data["style"]
+    for slide_data in template["slides"]:
+        s_type = slide_data["type"]
 
-# ---------- ç”Ÿæˆå¹»ç¯ç‰‡ ----------
-prs = Presentation()
+        if s_type == "title":
+            slide = add_title_slide(prs, slide_data, style)
+        elif s_type == "section":
+            slide = add_section_slide(prs, slide_data, style)
+        elif s_type == "content":
+            slide = add_content_slide(prs, slide_data, style, image_dir=args.image_dir)
+        elif s_type == "closing":
+            slide = add_closing_slide(prs, slide_data, style)
+        else:
+            continue
 
-for slide_data in template["slides"]:
-    s_type = slide_data["type"]
+        bg_config = style["background"].get(s_type, {"type": "solid", "color": "#FFFFFF"})
+        set_background(slide, bg_config, prs)
 
-    if s_type == "title":
-        slide = add_title_slide(prs, slide_data, style)
-    elif s_type == "section":
-        slide = add_section_slide(prs, slide_data, style)
-    elif s_type == "content":
-        slide = add_content_slide(prs, slide_data, style)
-    elif s_type == "closing":
-        slide = add_closing_slide(prs, slide_data, style)
-    else:
-        continue
+    os.makedirs(os.path.dirname(output_path), exist_ok=True)
+    prs.save(output_path)
+    print(f"PPT ç”ŸæˆæˆåŠŸ: {output_path}")
 
-    bg_config = style["background"].get(s_type, {"type": "solid", "color": "#FFFFFF"})
-    set_background(slide, bg_config, prs)
 
-# ---------- ä¿å­˜æ–‡ä»¶ ----------
-os.makedirs(os.path.dirname(output_path), exist_ok=True)
-prs.save(output_path)
-print(f"PPT ç”ŸæˆæˆåŠŸ: {output_path}")
+if __name__ == "__main__":
+    main()
diff --git a/readme.md b/readme.md
index f16c610..6e0276a 100644
--- a/readme.md
+++ b/readme.md
@@ -8,107 +8,113 @@
 
 ```
 auto-ppt/
 â”œâ”€â”€ main.py                        # ä¸»ç¨‹åºå…¥å£
 â”œâ”€â”€ output/                        # è¾“å‡ºç”Ÿæˆçš„ PPT æ–‡ä»¶   
 â”œâ”€â”€ slides/                        # å†…å®¹ç»“æ„ JSON æ–‡ä»¶
 â”‚   â””â”€â”€ ç¤ºä¾‹ï¼šé¡¹ç›®ä»‹ç».json
 â”œâ”€â”€ styles/                        # æ ·å¼æ¨¡æ¿ JSON æ–‡ä»¶
 â”‚   â””â”€â”€ ç¤ºä¾‹ï¼štech_dark.json
 â”œâ”€â”€ assets/
 â”‚   â””â”€â”€ backgrounds/               # èƒŒæ™¯å›¾åƒæ–‡ä»¶ï¼ˆç”¨äº image/mixed èƒŒæ™¯ï¼‰
 â”œâ”€â”€ tools/                         # å·¥å…·æ¨¡å—
 â”‚   â”œâ”€â”€ font_utils.py             # å­—ä½“ä¸åŠ¨æ€å­—å·è®¾ç½®
 â”‚   â”œâ”€â”€ slide_types.py            # å„ç§å¹»ç¯ç‰‡ç±»å‹çš„ç”Ÿæˆå‡½æ•°
 â”‚   â”œâ”€â”€ insert_placeholder.py     # æ’å›¾ç•™ç™½å¤„ç†
 â”‚   â”œâ”€â”€ background_utils.py       # èƒŒæ™¯è®¾ç½®å·¥å…·ï¼ˆæ”¯æŒå›¾å±‚ç½®åº•ï¼‰
 ```
 
 ---
 
 ## ä½¿ç”¨è¯´æ˜
 
 ### 1. å®‰è£…ä¾èµ–
 
 ```
-pip install python-pptx
+pip install -r requirements.txt
 ```
 
 ### 2. å‡†å¤‡å†…å®¹æ–‡ä»¶å’Œæ ·å¼æ¨¡æ¿
 
 #### å†…å®¹ç»“æ„ï¼ˆ`slides/*.json`ï¼‰
 
 ```json
 {
   "slides": [
     {
       "type": "title",
       "title": "æˆ‘çš„PPTæ ‡é¢˜",
       "subtitle": "å‰¯æ ‡é¢˜"
     },
     {
       "type": "section",
       "title": "ç¬¬ä¸€éƒ¨åˆ†"
     },
     {
       "type": "content",
       "title": "æŠ€æœ¯åŸç†",
       "bullets": [
         "ç³»ç»Ÿè®¾è®¡æ€è·¯",
-        "ã€æ’å›¾ã€‘æ•´ä½“æ¶æ„å›¾"
+        "ã€æ’å›¾ã€‘æ•´ä½“æ¶æ„å›¾"  
+        // ä»¥ã€æ’å›¾ã€‘å¼€å¤´çš„å†…å®¹ä¼šåœ¨å›¾ç‰‡ç›®å½•ä¸­åŒ¹é…å¹¶æ’å…¥å¯¹åº”å›¾ç‰‡
       ]
     },
     {
       "type": "closing",
       "title": "æ„Ÿè°¢è†å¬",
       "subtitle": "æ¬¢è¿æé—®"
     }
   ]
 }
 ```
 
 #### æ ·å¼æ¨¡æ¿ï¼ˆ`styles/*.json`ï¼‰
 
 æ”¯æŒå¦‚ä¸‹ç»“æ„ï¼ˆæ¯ç±»é¡µé¢çš„æ ‡é¢˜/å‰¯æ ‡é¢˜/bullet åˆ†åˆ«å®šä¹‰ï¼‰ï¼š
 
 ```json
 {
   "style": {
     "title": {
       "title_text": {...},
       "subtitle_text": {...}
     },
     "content": {
       "title_text": {...},
       "bullet_text": {...}
     },
     "closing": {
       "title_text": {...},
       "subtitle_text": {...}
     },
     "background": {
       "title": {
         "type": "image",
         "image": "assets/backgrounds/tech_dark.png"
       }
     }
   }
 }
 ```
 
 ### 3. è¿è¡Œç¨‹åº
 
-ç¨‹åºå°†è‡ªåŠ¨ç”Ÿæˆå¦‚ä¸‹è¾“å‡ºè·¯å¾„ï¼š
+ä½¿ç”¨å‘½ä»¤è¡Œå‚æ•°æŒ‡å®šæ¨¡æ¿ã€æ ·å¼ã€è¾“å‡ºç›®å½•ä»¥åŠå›¾ç‰‡ç›®å½•ï¼Œä¾‹å¦‚ï¼š
 
+```bash
+python main.py --template slides/example.json \
+               --style styles/style1.json \
+               --output_dir output \
+               --image_dir images
 ```
-output/é¡¹ç›®ä»‹ç»_tech_dark.pptx
-```
+
+ç”Ÿæˆçš„æ–‡ä»¶å°†ä¿å­˜åœ¨ `output` ç›®å½•ä¸‹ï¼Œæ–‡ä»¶åç”±æ¨¡æ¿å’Œæ ·å¼åç§°ç»„åˆè€Œæˆã€‚
 
 ---
 
 
 ## ğŸ¨ æç¤ºè¯æ¨¡æ¿
 ```
 /prompt_template/ å†…å®¹å¯ä»¥ä½¿ç”¨
 ```
 
 
diff --git a/requirements.txt b/requirements.txt
new file mode 100644
index 0000000..38b29a6
--- /dev/null
+++ b/requirements.txt
@@ -0,0 +1,2 @@
+python-pptx
+Pillow
diff --git a/tools/background_utils.py b/tools/background_utils.py
index 7154e5f..812616a 100644
--- a/tools/background_utils.py
+++ b/tools/background_utils.py
@@ -13,26 +13,26 @@ def set_background(slide, background_config, prs):
         fill.fore_color.rgb = RGBColor(int(color[1:3], 16), int(color[3:5], 16), int(color[5:7], 16))
 
     elif bg_type == "image":
         image_path = background_config.get("image")
         if image_path and os.path.exists(image_path):
             width = prs.slide_width
             height = prs.slide_height
             pic = slide.shapes.add_picture(image_path, Inches(0), Inches(0), width=width, height=height)
             # å°†èƒŒæ™¯å›¾å…ƒç´ ç§»åˆ°æœ€åº•å±‚
             sp_tree = slide.shapes._spTree
             sp_tree.remove(pic._element)
             sp_tree.insert(2, pic._element)  # é€šå¸¸ç´¢å¼• 0 æ˜¯ placeholderï¼Œ1 æ˜¯èƒŒæ™¯ï¼Œåº”æ’å…¥é å‰ä½†ä¸è¦†ç›–å†…å®¹
     elif bg_type == "mixed":
         # å…ˆè®¾ç½®åº•è‰²å†æ·»åŠ å›¾åƒè¦†ç›–ï¼ˆå¦‚æ¸å˜å›¾ï¼‰
         color = background_config.get("color", "#FFFFFF")
         image_path = background_config.get("image")
         fill.solid()
         fill.fore_color.rgb = RGBColor(int(color[1:3], 16), int(color[3:5], 16), int(color[5:7], 16))
         if image_path and os.path.exists(image_path):
             width = prs.slide_width
             height = prs.slide_height
             pic = slide.shapes.add_picture(image_path, Inches(0), Inches(0), width=width, height=height)
             # å°†èƒŒæ™¯å›¾å…ƒç´ ç§»åˆ°æœ€åº•å±‚
             sp_tree = slide.shapes._spTree
             sp_tree.remove(pic._element)
-            sp_tree.insert(2, pic._element)  # é€šå¸¸ç´¢å¼• 0 æ˜¯ placeholderï¼Œ1 æ˜¯èƒŒæ™¯ï¼Œåº”æ’å…¥é å‰ä½†ä¸è¦†ç›–å†…å®¹
\ No newline at end of file
+            sp_tree.insert(2, pic._element)  # é€šå¸¸ç´¢å¼• 0 æ˜¯ placeholderï¼Œ1 æ˜¯èƒŒæ™¯ï¼Œåº”æ’å…¥é å‰ä½†ä¸è¦†ç›–å†…å®¹
diff --git a/tools/insert_image_file.py b/tools/insert_image_file.py
index 2cba8cb..29e1d84 100644
--- a/tools/insert_image_file.py
+++ b/tools/insert_image_file.py
@@ -1,33 +1,28 @@
 import os
-import re
 from difflib import get_close_matches
 from pptx.util import Inches
-
-
-def extract_illustration_keyword(text):
-    match = re.search(r"ã€æ’å›¾ã€‘(.*)", text)
-    return match.group(1).strip() if match else None
+from tools.tag_utils import extract_illustration_keyword
 
 
 def find_matching_image(keyword, folder="images"):
     if not keyword or not os.path.exists(folder):
         return None
     candidates = os.listdir(folder)
     matches = get_close_matches(keyword.replace(" ", "").lower(), [f.lower() for f in candidates], n=1, cutoff=0.4)
     if matches:
         for candidate in candidates:
             if candidate.lower() == matches[0]:
                 return os.path.join(folder, candidate)
     return None
 
 
 def insert_image(slide, image_path):
     if not image_path:
         return
     left = Inches(5.5)
     top = Inches(2)
     width = Inches(3.5)
     try:
         slide.shapes.add_picture(image_path, left, top, width=width)
     except Exception as e:
         print(f"æ’å›¾å¤±è´¥ï¼š{image_path}", e)
diff --git a/tools/insert_placeholder.py b/tools/insert_placeholder.py
index dc81703..535150e 100644
--- a/tools/insert_placeholder.py
+++ b/tools/insert_placeholder.py
@@ -1,30 +1,25 @@
 from pptx.util import Inches, Pt
 from pptx.dml.color import RGBColor
-import re
-
-
-def extract_illustration_keyword(text):
-    match = re.search(r"ã€æ’å›¾ã€‘(.*)", text)
-    return match.group(1).strip() if match else None
+from tools.tag_utils import extract_illustration_keyword
 
 
 def insert_placeholder_box(slide, keyword):
     if not keyword:
         return
     left = Inches(5.5)
     top = Inches(2)
     width = Inches(3.5)
     height = Inches(2.5)
     shape = slide.shapes.add_shape(
         autoshape_type_id=1,  # Rectangle
         left=left,
         top=top,
         width=width,
         height=height
     )
     shape.text = f"[å¾…æ·»åŠ æ’å›¾ï¼š{keyword}]"
     text_frame = shape.text_frame
     p = text_frame.paragraphs[0]
     p.font.size = Pt(12)
     p.font.bold = True
     p.font.color.rgb = RGBColor(200, 200, 200)
diff --git a/tools/slide_types.py b/tools/slide_types.py
index 6436e46..d4886af 100644
--- a/tools/slide_types.py
+++ b/tools/slide_types.py
@@ -1,65 +1,71 @@
 from pptx.enum.text import PP_ALIGN
 from pptx.util import Inches
 from tools.font_utils import set_font
-from tools.insert_placeholder import extract_illustration_keyword, insert_placeholder_box
+from tools.insert_placeholder import insert_placeholder_box
+from tools.insert_image_file import find_matching_image, insert_image
+from tools.tag_utils import extract_illustration_keyword
 
 
 def add_title_slide(prs, slide_data, style):
     slide = prs.slides.add_slide(prs.slide_layouts[0])
     slide.shapes.title.text = slide_data["title"]
     subtitle = slide.placeholders[1]
     subtitle.text = slide_data.get("subtitle", "")
     set_font(slide.shapes.title.text_frame.paragraphs[0], style, path="title.title_text")
     set_font(subtitle.text_frame.paragraphs[0], style, path="title.subtitle_text")
     return slide
 
 
 def add_section_slide(prs, slide_data, style):
     slide = prs.slides.add_slide(prs.slide_layouts[6])
     slide_width = prs.slide_width
     slide_height = prs.slide_height
     box_width = Inches(10)
     box_height = Inches(1.5)
     left = int((slide_width - box_width) / 2)
     top = int((slide_height - box_height) / 2)
 
     textbox = slide.shapes.add_textbox(left, top, box_width, box_height)
     tf = textbox.text_frame
     tf.clear()
     p = tf.paragraphs[0]
     p.text = slide_data["title"]
     set_font(p, style, path="section.title_text")
     p.alignment = PP_ALIGN.CENTER
     return slide
 
 
-def add_content_slide(prs, slide_data, style):
+def add_content_slide(prs, slide_data, style, image_dir="images"):
     slide = prs.slides.add_slide(prs.slide_layouts[1])
     slide.shapes.title.text = slide_data["title"]
     set_font(slide.shapes.title.text_frame.paragraphs[0], style, path="content.title_text")
 
     tf = slide.placeholders[1].text_frame
     tf.clear()
 
     for bullet in slide_data["bullets"]:
         p = tf.add_paragraph()
         p.text = bullet
         set_font(p, style, path="content.bullet_text")
 
         keyword = extract_illustration_keyword(bullet)
         if keyword:
-            insert_placeholder_box(slide, keyword)
+            image_path = find_matching_image(keyword, image_dir)
+            if image_path:
+                insert_image(slide, image_path)
+            else:
+                insert_placeholder_box(slide, keyword)
 
     return slide
 
 
 def add_closing_slide(prs, slide_data, style):
     slide = prs.slides.add_slide(prs.slide_layouts[1])
     slide.shapes.title.text = slide_data["title"]
     tf = slide.placeholders[1].text_frame
     tf.clear()
     p = tf.paragraphs[0]
     p.text = slide_data.get("subtitle", "")
     set_font(slide.shapes.title.text_frame.paragraphs[0], style, path="closing.title_text", alignment="center")
     set_font(p, style, path="closing.subtitle_text")
     return slide
diff --git a/tools/tag_utils.py b/tools/tag_utils.py
new file mode 100644
index 0000000..b1889a4
--- /dev/null
+++ b/tools/tag_utils.py
@@ -0,0 +1,7 @@
+import re
+
+
+def extract_illustration_keyword(text: str) -> str | None:
+    """Extract the keyword after the illustration tag."""
+    match = re.search(r"ã€æ’å›¾ã€‘(.*)", text)
+    return match.group(1).strip() if match else None
